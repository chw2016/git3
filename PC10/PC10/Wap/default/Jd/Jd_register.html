<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="format-detection" content="telephone=no"/><!-- 不将数字识别为电话号码 -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
<title>会员注册</title>
<link rel="stylesheet" type="text/css" href="{weikucms::RES}/Jd/css/login.css">

    <link rel="stylesheet" type="text/css" href="{weikucms::RES}/Jd/css/font-awesome.min.css">
<script src="tpl/Wap/default/common/commerce/js/jquery-1.11.1.min.js"></script>
<script src="{weikucms::STATICS}/wapweiui/weiweb/sellcar/js/jquery.form.js" type="text/javascript"></script>
<script type="text/javascript" src="/tpl/static/common/msg.js"></script>
</head>
<style>

::-webkit-input-placeholder{
    color:#fff;
}

select:not(:-internal-list-box) {
    overflow: visible;
}
select {
    -webkit-appearance: menulist;
    box-sizing: border-box;
    align-items: center;
    border: 1px solid;
    border-image-source: initial;
    border-image-slice: initial;
    border-image-width: initial;
    border-image-outset: initial;
    border-image-repeat: initial;
    white-space: pre;
    -webkit-rtl-ordering: logical;
    color: #000;
    background-color: #FFF;
    cursor: default;
}
input, textarea, keygen, select, button {
    margin: 0em;
    font: normal normal normal 13.3333330154419px/normal Arial;
    color: initial;
    letter-spacing: normal;
    word-spacing: normal;
    text-transform: none;
    text-indent: 0px;
    text-shadow: none;
    display: inline-block;
    text-align: start;
}
select  {
    -webkit-user-select: auto;
    -webkit-box-shadow: none;
    box-shadow: none;
    -webkit-appearance: none;
    border-radius: 0;
    -webkit-border-radius: 0;
}
.poab{
    position: absolute;
    margin-top: 42px;
    left: 271px;
    top: 598px;
    color: #CFCFCF;
}
.poab1{
    position: absolute;
    top: 68px;
    right: 10px;
    color: #747474;
}
.fa {
    display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    transform: translate(0, 0);
}
</style>
<body>
<style>

#fileupload{
  font-size: 20px;
    margin-left: 35%;
    width: 100px;
opacity: 0;
}
</style>
	<div class="top" style="position:relative">
        <div class="imgs header file1" style="width: 100px;">
            <img id="img" onclick="clp();" src="" width="100%" height="100%"><!-- {weikucms::RES}/Jd/images/li1.png -->
        </div>

        <!-- {weikucms:$wxusers['headimgurl']} -->
        <div  class="file1" style="  font-size: 15px; clear: both; margin: 0 auto; text-align: center;color: #FFF; margin-top: 10px;" >点击上传图片</div>
        <form id="myupload" action="{weikucms::U('Wap/Commercedyb/uploadsT', array('openid' => $openid, 'token' => $token))}"  enctype="multipart/form-data">
        <input id="fileupload" type="file" name="mypic">
        </form>
	</div>
<script>
$("#aaa").click(function(){
	//alert(1);
})

</script>

	<div class="bodys">
		<div class="mr">
			<input type="text" class="input_name" name="u_name" id="u_name" placeholder="*请输入您的真实姓名" onfocus="if (placeholder =='*请输入您的真实姓名'){placeholder =''}"onblur="if (placeholder ==''){placeholder='*请输入用户帐号'}" >
            <!--<input type="text" class="input_name" name="true_name" id="true_name" placeholder="*请输入用户实名" onfocus="if (placeholder =='*请输入用户实名'){placeholder =''}"onblur="if (placeholder ==''){placeholder='*请输入用户实名'}" >-->
            <input type="password" class="input_name" name="u_password" id="u_password" placeholder="*请输入密码" onfocus="if (placeholder =='*请输入密码'){placeholder =''}"onblur="if (placeholder ==''){placeholder='*请输入密码'}" >
			<input type="password" class="input_name" name="re_u_password" id="re_u_password" placeholder="*请再次输入密码" onfocus="if (placeholder =='*请再次输入密码'){placeholder =''}"onblur="if (placeholder ==''){placeholder='*请再次输入密码'}">
			<input type="text" class="input_name" name="u_email" id="u_email" placeholder="*请填写邮箱" onfocus="if (placeholder =='*请填写邮箱'){placeholder =''}"onblur="if (placeholder ==''){placeholder='*请填写邮箱'}">
			<input type="tel" class="input_name" name="u_phone" id="u_phone" placeholder="*请填写手机号码" onfocus="if (placeholder =='请填写手机号码'){placeholder =''}"onblur="if (placeholder ==''){placeholder='请填写手机号码'}">
			<input type="tel" class="input_name" name="u_qq" id="u_qq" placeholder="*请填写QQ" onfocus="if (placeholder =='请填写QQ'){placeholder =''}"onblur="if (placeholder ==''){placeholder='请填写QQ'}">
		    <!--<input type="text" class="input_name" name="jg" id="jg" style="text-indent: 5px" placeholder="填写机构,机构或伙伴只能二选一" onfocus="if (placeholder =='填写机构,机构或伙伴只能二选一'){placeholder =''}"onblur="if (placeholder ==''){placeholder='填写机构,机构或伙伴只能二选一'}">-->
		    <select name="type" style="width: 100%;border: 0;outline: none;border: 1px solid #3488E6;height: 48px;border-radius: 5px;color: #FFF;background-color: #016AE0;/* text-align: center; */padding-left: 25%;font-size: 16px;/* font-weight: 500; */margin-bottom: 20px;font-family: '微软雅黑'" id="type">
                <option value="">请选择组织类别</option>
                <option value="0">总部</option>
                <option value="1">机构</option>
                <option value="2">伙伴</option>
		    </select>
            <i class="fa fa-sort-desc poab"></i>
            <input type="text" class="input_name" name="hb" id="hb" style="text-indent: 5px" placeholder="*请填写完整的组织的名称" onfocus="if (placeholder =='请填写完整的组织的名称'){placeholder =''}"onblur="if (placeholder ==''){placeholder='请填写完整的组织的名称'}">
			<span id="put" class="btn_login">注册</span>
			<div class="ts">
				<span style="float:left"><a style="color:#4e97e9;" href="{weikucms::U('aaa',array('token'=>session('token'),'openid'=>$openid))}">忘记密码</a></span>
                <span style="float:right"><a style="color:#4e97e9;" href="{weikucms::U('login',array('token'=>session('token'),'openid'=>$openid))} ">返回登录</a></span>
			</div>
		</div>
	</div>
    <script type="text/javascript">
   /*
    $(function(){var bar=$('.bar');
    var percent=$('.percent');
    var showimg=$('#showimg');
    var progress=$(".progress");
    var files=$(".files");
    var btn=$(".btn span.fixColor");
    $("#fileupload").change(function(){$("#myupload").ajaxSubmit({dataType:'json',beforeSend:function(){showimg.empty();
    progress.show();var percentVal='0%';bar.width(percentVal);
    percent.html(percentVal);btn.html("涓婁紶涓�...")
    ;},success:function(data){$("#url").val(data.pic);
    var img=data.pic;showimg.html("<a href='"+img+"'> <img src='"+img+"'width='100px;' height='80px;' style='position:relative;left:-12px;'></a>");
    btn.html("鍥剧墖澶у皬涓嶈瓒呰繃3M");},error:function(xhr){btn.html("涓婁紶澶辫触");
    bar.width('0')
    files.html(xhr.responseText);}})
    ;})
    ;}); */


    var url="{weikucms::U('Jd/register',array('token'=>session('token')))}";
    $('#put').click(function(){

        var u_name=$('#u_name').val();
        var u_password=$('#u_password').val();
        var re_u_password=$('#re_u_password').val();
        var u_email=$('#u_email').val();
        var u_phone=$('#u_phone').val();
        var u_qq=$('#u_qq').val();
        var type = $("#type").val();
        var hb = $("#hb").val();
        var img = $("#img").attr("src");
        var true_name=$("#true_name").val();
        /*if(jg && hb){
            msg.alert('机构或伙伴只能二选一');
            return false;
        }*/

        if(u_name==''){
            msg.alert('请输入您的真实姓名');
            return false;
        }
        /*if(true_name==''){
            msg.alert('请输入用户实名');
            return false;
        }*/
        if(u_password==''){
        msg.alert('请填写登录密码');
        return false;
        }
        if(re_u_password==''){
        msg.alert('请确认登录密码');
        return false;
        }
        if(u_email==''){
        msg.alert('请填写有效的登录邮箱');
        return false;
        }
        if(!isEmail(u_email)){
        msg.alert('邮箱格式不正确');
        return false;
        }
        if(!isPhone(u_phone)){
        msg.alert('手机格式不正确');
        return false;
        }
        if(!isInteger(u_qq)){
        msg.alert('QQ格式不正确');
        return false;
        }
        msg.alert('正在提交数据....', 100000);
        $.post(url,{true_name:true_name,u_name:u_name,u_password:u_password,re_u_password:re_u_password,u_email:u_email,u_phone:u_phone,u_qq:u_qq,type:type,hb:hb,img:img},function(data){
            if(data.status){
                msg.alert('注册成功！');
                window.location=data.url;
            }else{
                msg.alert(data.msg);
            }
        },'json');
    });

        /**
        * 检查字符串是否为合法email地址
        * @param {String} 字符串
        * @return {bool} 是否为合法email地址
        */
        function isEmail(aEmail) {
            var bValidate = RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(aEmail);
            if (bValidate) {
                return true;
            }else{
                return false;
            }
        }
        //是否手机号
        function isPhone(aPhone) {
            var bValidate = RegExp(/^(0|86|17951)?(13[0-9]|15[012356789]|18[0-9]|14[57])[0-9]{8}$/).test(aPhone);
            if (bValidate) {
                return true;
            }
            else
                return false;
        }
        /**
        * 检查字符串是否是整数
        * @param {String} 字符串
        * @return {bool} 是否是整数
        */
        function isInteger(s) {
            var isInteger = RegExp(/^[0-9]+$/);
            return (isInteger.test(s));
        }


        var bar=$('.bar');
        var percent=$('.percent');
        var showimg=$('#showimg');
        var progress=$(".progress");
        var files=$(".files");
        var btn=$(".btn span.fixColor");
        $("#fileupload").change(function(){
            $("#myupload").ajaxSubmit({
                dataType:'json',
                beforeSend:function(){
                    msg.alert('正在上传...', 100000);
                },
                success:function(data){
                    $('.header img').attr('src', data.pic);
                    msg.alert('上传完成', 1000);
                },
                error:function(xhr){
                    msg.alert('上传失败，请重新上传', 1000);
                }});
        });

        function clp(){
            return $('#fileupload').click();
        }
    </script>


</body>
</html>
